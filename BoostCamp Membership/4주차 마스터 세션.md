# 아마존 카로셀 백엔드 마무리

## GitHub 관리

### 좋은 저장소란

- 읽기 좋은 저장소

## 좋은 커밋 메시지

- 읽기 좋은 커밋
- 원자적인 커밋
- 커밋 내용이 한 문장으로 요약되지 않는다면 커밋 나누기!
- 커밋 작성에 최소 2분만 시간을 투자하자!
- https://meetup.toast.com/posts/106
- https://soojin.ro/review/cl-descriptions
- 오타가 나더라도 무슨 오타가 났는지 적어주기

## 객체지향 체조

출처: 쏘트 웍스 앤솔로지

```
규칙 1: 한 메서드에 오직 한 단계의 들여쓰기만 한다.
규칙 2: else 예약어를 쓰지 않는다.
규칙 3: 모든 원시값과 문자열을 포장한다.
규칙 4: 한 줄에 점을 하나만 찍는다.
규칙 5: 줄여쓰지 않는다(축약 금지).
규칙 6: 모든 엔티티를 작게 유지한다.
규칙 7: 2개 이상의 인스턴스 변수를 가진 클래스를 쓰지 않는다.
규칙 8: 일급 콜렉션을 쓴다.
규칙 9: 게터/세터/프로퍼티를 쓰지 않는다.
```

원칙: 읽기 좋은 코드!

자바스크립트에 내용을 추가한다면 '콜백은 2단계 이상 사용하지 않는다' 정도 어떨까?

## 자바스크립트스럽게 코딩하기

- 있어 보인다!
- 최신 JS의 기능 잘 사용하기 (무분별하게 사용하지 않기)
- 변수 그리고 메소드 이름은 조금 더 고민해서 짓자!
- 매개변수가 많거나 옵션이 있다면 객체 사용
- 비동기는 async await이 가장 무난
- 함수형 자바 스크립트
- 객체 지향 자바 스크립트

## express

### 안전한 패스워드 암호화 알고리즘

- 단방향 해시 알고리즘 사용
- 소요시간: 실서버 기준으로 0.2초 권장 (수동으로 테스트해 볼 것) 이렇게 설정을 해 놓으면, 1초에 5번 밖에 시도를 못하기 때문에 해킹 위험이 많이 낮아진다.
- 비동기를 사용하자. 동기로 하는 경우가 많은데 반드시 비동기로 해야한다.
- salt 사용하기
  - 단방향 해시 함수에서 다이제스트를 생성할 때 추가되는 바이트 단위의 임의의 문자열
- 조금 더 안전한 알고리즘: pbkdf2, bcrypt
- https://d2.naver.com/helloworld/318732
- https://www.npmjs.com/package/bcrypt

## 데이터베이스

- 가능하면 호출 회수를 줄이는 게 좋다.
  - 데이터 베이스가 병목현상이 일으키는 일이 가장 많다.
- 크게 신경쓰지는 말자
- mysql2의 기능을 잘 쓰자.
- Prepared statement
  - ORM을 쓰기 때문에 SQL을 직접 쓸 일이 없어서 괜찮음
- 언제나 비동기로 구현
- https://www.npmjs.com/package/mysql2
- Model을 이용해서 쿼리를 분리하는 것 추천
- ORM 사용 권장 (Sequelize 등)

## 설계

- 좋은 설계란?
- 언어의 철학, 프레임워크의 철학을 잘 지키자
- 객체 지향 프로그래밍: Data VS Method

### 변수명 메소드명

- 변수명과 메소드명에 조금 더 신경을 쓰자
- 명사의 단수 / 복수에 유의할 것
- 메소드는 동사로 시작하는 것이 좋다.
- 한 메소드는 하나의 일을 하게
- 메소드 이름을 가지고 행동을 유추할 수 있게 이름을 짓는다.
- 메소드나 객체가 깊은 의존성을 가지지 않도록 구현한다.
  -  한 메소드를 사용하기 위해 다른 메소드를 소환해야하는 경우

### 백엔드 설계

- URL을 기준으로 설계한다.
- Semantic URL 권장
- https://developer.github.com/v3/ 참고

## 기타

- 사용하는 패키지의 공식 문서 꼭 읽자!

학습 완료



## 코드 리뷰

- Fix Typo만 하더라도 How가 아니라 What 과 Why를 적어주자. 어떤 오타가 왜 났고 어떤 에러를 야기했는지.

- 파일 이름도 구체적으로 적어주는 게 좋다. query.js => 좀 더 구체적으로

- .env 파일을 .ignore에 넣어 놓으면 실행 시킬 수 없으니까, 변수 명이라도 남겨 놓는 것이 좋다.

- require('dotenv').config()는 앞에 쓸 수록 좋다. 또한 이런거는 app.js에 한 번만 넣어도 된다.

- bodyParser는 없어도 된다. `app.use(express.urlencoded({ extended: false }));` 이 bodyParser역할을 이미 하고 있기 때문에, 중복이다.

- 쿼리는 모델에다가 만들어라. SS63참고(만)

  - models/users.js 파일을 만들고 여기서 작성
  - models 안에 모아 놓고 파일 하나에서 모아 넣는 것도 좋음

- 쿼리를 작성할 때는 SELECT * 를 하지 말고, attribute를 하나씩 다 적어주는게 좋다. 성능도 좋고 가독성도 좋아진다.

- 데이터 베이스 초기화도 js로 하는 방법을 공부해보자아

  ```
  source ../.env
  
  mysql -u $DB_USER -p .. <= QUERY
  ```

- DB는 가능하면 DROP하지 말고 TABLE만 비워주는게 좋다.

- 데이터 베이스에 본문을 VARCHAR() 로 하면 그 이상을 넘어갔을 때 기록이 안된다. TEXT 타입을 사용하자

- SQL도 하나의 파일로 빼주는 것이 좋다.

- SQL 쿼리 파일들을 단계별로 migration을 다 저장 하는게 좋다. 이렇게 했을 때, 나중에 단계별로 migration을 따라가면 최종 스키마가 나올 수 있게 된다.

- 